#!/usr/bin/env bash
# Script to configure Nginx with a 301 redirection from /redirect_me to another page

# Create a backup of the default Nginx configuration file
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.backup

# Define the server block with the redirection
server_block=$(cat <<EOF
server {
    listen 80;
    server_name _;

    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
    }

    location / {
        # Other configurations (if any)
    }
}
EOF
)

# Write the server block to the default site configuration
echo "$server_block" | sudo tee /etc/nginx/sites-available/default

# Test the configuration for syntax errors
sudo nginx -t

# If the test is successful, restart Nginx to apply the changes
if [ $? -eq 0 ]; then
  sudo systemctl restart nginx
else
  echo "Nginx configuration test failed."
  exit 1
fi
